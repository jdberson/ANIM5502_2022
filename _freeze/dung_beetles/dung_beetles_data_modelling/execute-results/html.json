{
  "hash": "b2a10a82469a787d8d4c94ec6e5835f7",
  "result": {
    "markdown": "---\ntitle: \"Data modelling\"\n---\n\n\n## Setup\n\nHere we load the packages, set the ggplot theme and load the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"tidyverse\")\nlibrary(\"broom\")\nlibrary(\"emmeans\")\n```\n:::\n\n\nSet the ggplot theme for all plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntheme_set(theme_minimal())\ntheme_update(strip.text = element_text(face = \"bold\", size=10, hjust=0), \n             strip.background = element_rect(fill = \"grey80\", colour = NA),\n             axis.text = element_text(size=10, colour = \"black\"),\n             axis.title = element_text(size=12, colour = \"black\"))\n```\n:::\n\n\nImport the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in the data\ndb_data <- \n  read_csv(\"data/db_data.csv\") %>%\n  \n  # Some R packages require factors to be explicit\n  mutate(across(.cols = c(id:shipment, treatment:sex), as.factor))\n```\n:::\n\n\n## Hypothesis #1\n\nFirst we want to know whether the treatment had an immediate effect on beetle morphology, and whether this effect differed for the two species.\n\nRecall from our data exploration that two of the *Onthophagus vacca* shipments did not have both treatments. We will filter these out for our analysis, as well as generations other than the first generation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter data\ndb_data_F1 <-\n  db_data %>%\n              filter(generation == 1 &\n                     !shipment %in% c(\"5A\", \"5B\")) %>%\n  droplevels()\n\n# Check sample sizes\ndb_data_F1 %>%\n  drop_na(pronotum_width) %>%\n  group_by(treatment, sex, shipment, species) %>%\n  count()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"treatment\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"sex\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"shipment\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"species\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"CT\",\"2\":\"F\",\"3\":\"2\",\"4\":\"Onthophagus vacca\",\"5\":\"20\"},{\"1\":\"CT\",\"2\":\"F\",\"3\":\"4\",\"4\":\"Onthophagus vacca\",\"5\":\"25\"},{\"1\":\"CT\",\"2\":\"F\",\"3\":\"8\",\"4\":\"Onthophagus andalusicus\",\"5\":\"20\"},{\"1\":\"CT\",\"2\":\"F\",\"3\":\"9\",\"4\":\"Onthophagus andalusicus\",\"5\":\"20\"},{\"1\":\"CT\",\"2\":\"M\",\"3\":\"2\",\"4\":\"Onthophagus vacca\",\"5\":\"10\"},{\"1\":\"CT\",\"2\":\"M\",\"3\":\"4\",\"4\":\"Onthophagus vacca\",\"5\":\"25\"},{\"1\":\"CT\",\"2\":\"M\",\"3\":\"8\",\"4\":\"Onthophagus andalusicus\",\"5\":\"20\"},{\"1\":\"CT\",\"2\":\"M\",\"3\":\"9\",\"4\":\"Onthophagus andalusicus\",\"5\":\"20\"},{\"1\":\"Q\",\"2\":\"F\",\"3\":\"2\",\"4\":\"Onthophagus vacca\",\"5\":\"40\"},{\"1\":\"Q\",\"2\":\"F\",\"3\":\"4\",\"4\":\"Onthophagus vacca\",\"5\":\"10\"},{\"1\":\"Q\",\"2\":\"F\",\"3\":\"8\",\"4\":\"Onthophagus andalusicus\",\"5\":\"20\"},{\"1\":\"Q\",\"2\":\"F\",\"3\":\"9\",\"4\":\"Onthophagus andalusicus\",\"5\":\"14\"},{\"1\":\"Q\",\"2\":\"M\",\"3\":\"2\",\"4\":\"Onthophagus vacca\",\"5\":\"40\"},{\"1\":\"Q\",\"2\":\"M\",\"3\":\"4\",\"4\":\"Onthophagus vacca\",\"5\":\"10\"},{\"1\":\"Q\",\"2\":\"M\",\"3\":\"8\",\"4\":\"Onthophagus andalusicus\",\"5\":\"20\"},{\"1\":\"Q\",\"2\":\"M\",\"3\":\"9\",\"4\":\"Onthophagus andalusicus\",\"5\":\"8\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Fit the model\nm1a_pw <- lm(pronotum_width ~ treatment*species + sex, data = db_data_F1)\n\n# Check model conditions\npar(mfrow = c(2,2)); plot(m1a_pw); par(mfrow = c(1,1))\n```\n\n::: {.cell-output-display}\n![](dung_beetles_data_modelling_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Can look at a histogram of the residuals\nggplot(data = augment(m1a_pw), aes(x = .resid)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](dung_beetles_data_modelling_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Model results\ntidy(m1a_pw)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"4.50299960\",\"3\":\"0.07400067\",\"4\":\"60.8507942\",\"5\":\"6.606158e-177\"},{\"1\":\"treatmentQ\",\"2\":\"0.60435488\",\"3\":\"0.10022445\",\"4\":\"6.0300141\",\"5\":\"4.559668e-09\"},{\"1\":\"speciesOnthophagus vacca\",\"2\":\"0.07400005\",\"3\":\"0.09370054\",\"4\":\"0.7897505\",\"5\":\"4.302638e-01\"},{\"1\":\"sexM\",\"2\":\"-0.06199919\",\"3\":\"0.06617421\",\"4\":\"-0.9369088\",\"5\":\"3.495187e-01\"},{\"1\":\"treatmentQ:speciesOnthophagus vacca\",\"2\":\"0.09354507\",\"3\":\"0.13407069\",\"4\":\"0.6977295\",\"5\":\"4.858578e-01\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nThere is no strong evidence for an interaction effect. I think it's reasonable to simplify the model and drop the interaction.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the model\nm1b_pw <- lm(pronotum_width ~ treatment + species + sex, data = db_data_F1)\n\n# Check model conditions\npar(mfrow = c(2,2)); plot(m1b_pw); par(mfrow = c(1,1))\n```\n\n::: {.cell-output-display}\n![](dung_beetles_data_modelling_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Can look at a histogram of the residuals\nggplot(data = augment(m1b_pw), aes(x = .resid)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](dung_beetles_data_modelling_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Model results\n\n# Using the broom package\ntidy(m1b_pw)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"4.47893473\",\"3\":\"0.06541869\",\"4\":\"68.4656779\",\"5\":\"2.175877e-192\"},{\"1\":\"treatmentQ\",\"2\":\"0.65669959\",\"3\":\"0.06640473\",\"4\":\"9.8893493\",\"5\":\"2.778173e-20\"},{\"1\":\"speciesOnthophagus vacca\",\"2\":\"0.11976068\",\"3\":\"0.06686676\",\"4\":\"1.7910345\",\"5\":\"7.423870e-02\"},{\"1\":\"sexM\",\"2\":\"-0.05947216\",\"3\":\"0.06602168\",\"4\":\"-0.9007974\",\"5\":\"3.683778e-01\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nglance(m1b_pw)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"r.squared\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"adj.r.squared\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"logLik\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AIC\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BIC\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"deviance\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df.residual\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"nobs\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.2522969\",\"2\":\"0.2452431\",\"3\":\"0.5915588\",\"4\":\"35.7675\",\"5\":\"6.053938e-20\",\"6\":\"3\",\"7\":\"-285.8375\",\"8\":\"581.6751\",\"9\":\"600.5479\",\"10\":\"111.2815\",\"11\":\"318\",\"12\":\"322\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Using summary\nsummary(m1b_pw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = pronotum_width ~ treatment + species + sex, data = db_data_F1)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.86592 -0.30946  0.08434  0.37429  1.39130 \n\nCoefficients:\n                         Estimate Std. Error t value Pr(>|t|)    \n(Intercept)               4.47893    0.06542  68.466   <2e-16 ***\ntreatmentQ                0.65670    0.06640   9.889   <2e-16 ***\nspeciesOnthophagus vacca  0.11976    0.06687   1.791   0.0742 .  \nsexM                     -0.05947    0.06602  -0.901   0.3684    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5916 on 318 degrees of freedom\nMultiple R-squared:  0.2523,\tAdjusted R-squared:  0.2452 \nF-statistic: 35.77 on 3 and 318 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nWe have evidence for a treatment effect and some coefficients to help us understand what the effect is. The emmeans package can help us out a bit more here.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1b_pw_emm <- emmeans(m1b_pw, \"treatment\")\nm1b_pw_emm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n treatment emmean     SE  df lower.CL upper.CL\n CT          4.51 0.0468 318     4.42     4.60\n Q           5.17 0.0471 318     5.07     5.26\n\nResults are averaged over the levels of: species, sex \nConfidence level used: 0.95 \n```\n:::\n:::\n\n\nLet's plot the results with our raw data - this is a great sanity check to make sure something has not gone horribly wrong!\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Notice the use of tidy() from the broom package\nggplot(data = tidy(m1b_pw_emm, conf.int = TRUE), aes(x = treatment, y = estimate, colour = treatment, shape = treatment)) +\n  geom_point(size = 4) +\n geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0) + \n  geom_jitter(data = db_data_F1, aes(x = treatment, y = pronotum_width, colour = treatment), alpha = 0.2)\n```\n\n::: {.cell-output-display}\n![](dung_beetles_data_modelling_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Hypothesis #2\n\nNow let's investigate whether this effect persists across the generations.\n\nRecall that our most complete data is for *Onthophagus vacca* shipments 2 and 4 up to generation 3. Let's use just this data for this hypothesis for now.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter data\ndb_data_F1_3 <-\n  db_data %>%\n              filter(generation %in% c(1, 2, 3) &\n                     shipment %in% c(\"2\", \"4\")) %>%\n  droplevels()\n\n# Check sample sizes\ndb_data_F1_3 %>%\n  drop_na(pronotum_width) %>%\n  group_by(treatment, generation, sex, shipment) %>%\n  count() \n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"treatment\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"generation\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sex\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"shipment\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"CT\",\"2\":\"1\",\"3\":\"F\",\"4\":\"2\",\"5\":\"20\"},{\"1\":\"CT\",\"2\":\"1\",\"3\":\"F\",\"4\":\"4\",\"5\":\"25\"},{\"1\":\"CT\",\"2\":\"1\",\"3\":\"M\",\"4\":\"2\",\"5\":\"10\"},{\"1\":\"CT\",\"2\":\"1\",\"3\":\"M\",\"4\":\"4\",\"5\":\"25\"},{\"1\":\"CT\",\"2\":\"2\",\"3\":\"F\",\"4\":\"2\",\"5\":\"20\"},{\"1\":\"CT\",\"2\":\"2\",\"3\":\"F\",\"4\":\"4\",\"5\":\"24\"},{\"1\":\"CT\",\"2\":\"2\",\"3\":\"M\",\"4\":\"2\",\"5\":\"20\"},{\"1\":\"CT\",\"2\":\"2\",\"3\":\"M\",\"4\":\"4\",\"5\":\"26\"},{\"1\":\"CT\",\"2\":\"3\",\"3\":\"F\",\"4\":\"2\",\"5\":\"20\"},{\"1\":\"CT\",\"2\":\"3\",\"3\":\"F\",\"4\":\"4\",\"5\":\"25\"},{\"1\":\"CT\",\"2\":\"3\",\"3\":\"M\",\"4\":\"2\",\"5\":\"20\"},{\"1\":\"CT\",\"2\":\"3\",\"3\":\"M\",\"4\":\"4\",\"5\":\"25\"},{\"1\":\"Q\",\"2\":\"1\",\"3\":\"F\",\"4\":\"2\",\"5\":\"40\"},{\"1\":\"Q\",\"2\":\"1\",\"3\":\"F\",\"4\":\"4\",\"5\":\"10\"},{\"1\":\"Q\",\"2\":\"1\",\"3\":\"M\",\"4\":\"2\",\"5\":\"40\"},{\"1\":\"Q\",\"2\":\"1\",\"3\":\"M\",\"4\":\"4\",\"5\":\"10\"},{\"1\":\"Q\",\"2\":\"2\",\"3\":\"F\",\"4\":\"2\",\"5\":\"15\"},{\"1\":\"Q\",\"2\":\"2\",\"3\":\"F\",\"4\":\"4\",\"5\":\"15\"},{\"1\":\"Q\",\"2\":\"2\",\"3\":\"M\",\"4\":\"2\",\"5\":\"15\"},{\"1\":\"Q\",\"2\":\"2\",\"3\":\"M\",\"4\":\"4\",\"5\":\"15\"},{\"1\":\"Q\",\"2\":\"3\",\"3\":\"F\",\"4\":\"2\",\"5\":\"15\"},{\"1\":\"Q\",\"2\":\"3\",\"3\":\"F\",\"4\":\"4\",\"5\":\"20\"},{\"1\":\"Q\",\"2\":\"3\",\"3\":\"M\",\"4\":\"2\",\"5\":\"15\"},{\"1\":\"Q\",\"2\":\"3\",\"3\":\"M\",\"4\":\"4\",\"5\":\"20\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Fit the model\nm2a_pw <- lm(pronotum_width ~ treatment*generation*shipment, data = db_data_F1_3)\n\n# Check model conditions\npar(mfrow = c(2,2)); plot(m2a_pw); par(mfrow = c(1,1))\n```\n\n::: {.cell-output-display}\n![](dung_beetles_data_modelling_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Can look at a histogram of the residuals\nggplot(data = augment(m2a_pw), aes(x = .resid)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](dung_beetles_data_modelling_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Model results\ntidy(m2a_pw)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"4.84076316\",\"3\":\"0.14500238\",\"4\":\"33.384025\",\"5\":\"1.945034e-127\"},{\"1\":\"treatmentQ\",\"2\":\"1.01100428\",\"3\":\"0.17779522\",\"4\":\"5.686341\",\"5\":\"2.252374e-08\"},{\"1\":\"generation\",\"2\":\"-0.07697368\",\"3\":\"0.06484704\",\"4\":\"-1.187004\",\"5\":\"2.358108e-01\"},{\"1\":\"shipment4\",\"2\":\"-0.94149649\",\"3\":\"0.18596795\",\"4\":\"-5.062682\",\"5\":\"5.893637e-07\"},{\"1\":\"treatmentQ:generation\",\"2\":\"-0.37418911\",\"3\":\"0.08578025\",\"4\":\"-4.362183\",\"5\":\"1.575968e-05\"},{\"1\":\"treatmentQ:shipment4\",\"2\":\"-1.60767095\",\"3\":\"0.27243937\",\"4\":\"-5.901023\",\"5\":\"6.814546e-09\"},{\"1\":\"generation:shipment4\",\"2\":\"0.47887368\",\"3\":\"0.08432382\",\"4\":\"5.678985\",\"5\":\"2.345051e-08\"},{\"1\":\"treatmentQ:generation:shipment4\",\"2\":\"0.64996911\",\"3\":\"0.12447201\",\"4\":\"5.221809\",\"5\":\"2.640087e-07\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nglance(m2a_pw)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"r.squared\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"adj.r.squared\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"logLik\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AIC\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BIC\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"deviance\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df.residual\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"nobs\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.3541344\",\"2\":\"0.3447546\",\"3\":\"0.5390147\",\"4\":\"37.75504\",\"5\":\"3.687181e-42\",\"6\":\"7\",\"7\":\"-388.4208\",\"8\":\"794.8415\",\"9\":\"832.5912\",\"10\":\"140.0388\",\"11\":\"482\",\"12\":\"490\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsummary(m2a_pw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = pronotum_width ~ treatment * generation * shipment, \n    data = db_data_F1_3)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.2894 -0.2940  0.0632  0.3588  1.2262 \n\nCoefficients:\n                                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.84076    0.14500  33.384  < 2e-16 ***\ntreatmentQ                       1.01100    0.17780   5.686 2.25e-08 ***\ngeneration                      -0.07697    0.06485  -1.187    0.236    \nshipment4                       -0.94150    0.18597  -5.063 5.89e-07 ***\ntreatmentQ:generation           -0.37419    0.08578  -4.362 1.58e-05 ***\ntreatmentQ:shipment4            -1.60767    0.27244  -5.901 6.81e-09 ***\ngeneration:shipment4             0.47887    0.08432   5.679 2.35e-08 ***\ntreatmentQ:generation:shipment4  0.64997    0.12447   5.222 2.64e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.539 on 482 degrees of freedom\nMultiple R-squared:  0.3541,\tAdjusted R-squared:  0.3448 \nF-statistic: 37.76 on 7 and 482 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nLet's plot the results with the raw data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = augment(m2a_pw, se_fit = TRUE), \n       aes(x = generation, y = .fitted, colour = treatment)) +\n  geom_line() +\n  geom_ribbon(aes(ymin = .fitted - .se.fit, ymax = .fitted + .se.fit), \n              alpha = 0.2) +\n  geom_jitter(aes(x = generation, y = pronotum_width, colour = treatment), alpha = 0.2) +\n facet_wrap(~shipment)\n```\n\n::: {.cell-output-display}\n![](dung_beetles_data_modelling_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nThis does not look like a great fit, particularly for shipment 2.\n\nGiven the shipment 2 behaves differently to all the other shipments, I suggest we do some thorough checks of the data before pursuing more complex models.\n\nI'll end it here for now - we can extend/update the analyses at our next meeting.\n",
    "supporting": [
      "dung_beetles_data_modelling_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}